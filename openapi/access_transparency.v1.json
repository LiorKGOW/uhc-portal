{
  "components": {
    "parameters": {
      "access_request_id": {
        "description": "The id of the Access Request",
        "in": "path",
        "name": "access_request_id",
        "required": true,
        "schema": {
          "type": "string"
        }
      },
      "clusterId": {
        "description": "The Cluster id to check Access Protection status for.",
        "in": "query",
        "name": "clusterId",
        "required": false,
        "schema": {
          "type": "string"
        }
      },
      "decision_id": {
        "description": "The decision id of record",
        "in": "path",
        "name": "decision_id",
        "required": true,
        "schema": {
          "type": "string"
        }
      },
      "fields": {
        "description": "Supplies a comma-separated list of fields to be returned.\nFields of sub-structures and of arrays use <structure>.<field> notation.\n<stucture>.* means all field of a structure\nExample: For each Subscription to get id, href, plan(id and kind) and labels (all fields)\n\n```\nocm get subscriptions --parameter fields=id,href,plan.id,plan.kind,labels.* --parameter fetchLabels=true\n```",
        "in": "query",
        "name": "fields",
        "required": false,
        "schema": {
          "type": "string"
        }
      },
      "order": {
        "description": "Specifies the order by criteria. The syntax of this parameter is\nsimilar to the syntax of the _order by_ clause of an SQL statement,\nbut using the names of the json attributes / column of the account.\nFor example, in order to retrieve all accounts ordered by username:\n\n```sql\nusername asc\n```\n\nOr in order to retrieve all accounts ordered by username _and_ first name:\n\n```sql\nusername asc, firstName asc\n```\n\nParameters 'orderBy' and 'order' are mutually exclusive. If both \nparameters aren't provided, or if the values are empty, then no \nexplicit ordering will be applied.",
        "in": "query",
        "name": "order",
        "required": false,
        "schema": {
          "type": "string"
        }
      },
      "orderBy": {
        "description": "Specifies the order by criteria. The syntax of this parameter is\nsimilar to the syntax of the _order by_ clause of an SQL statement,\nbut using the names of the json attributes / column of the account.\nFor example, in order to retrieve all accounts ordered by username:\n\n```sql\nusername asc\n```\n\nOr in order to retrieve all accounts ordered by username _and_ first name:\n\n```sql\nusername asc, firstName asc\n```\n\nParameters 'orderBy' and 'order' are mutually exclusive. If both \nparameters aren't provided, or if the values are empty, then no \nexplicit ordering will be applied.",
        "in": "query",
        "name": "orderBy",
        "required": false,
        "schema": {
          "type": "string"
        }
      },
      "organizationId": {
        "description": "The OCM Organization id to check Access Protection status for.",
        "in": "query",
        "name": "organizationId",
        "required": false,
        "schema": {
          "type": "string"
        }
      },
      "page": {
        "description": "Page number of record list when record list exceeds specified page size",
        "in": "query",
        "name": "page",
        "required": false,
        "schema": {
          "default": 1,
          "minimum": 1,
          "type": "integer"
        }
      },
      "search": {
        "description": "Specifies the search criteria. The syntax of this parameter is\nsimilar to the syntax of the _where_ clause of an SQL statement,\nusing the names of the json attributes / column names of the account. \nFor example, in order to retrieve all the accounts with a username\nstarting with `my`:\n\n```sql\nusername like 'my%'\n```\n\nThe search criteria can also be applied on related resource.\nFor example, in order to retrieve all the subscriptions labeled by `foo=bar`,\n\n```sql\nsubscription_labels.key = 'foo' and subscription_labels.value = 'bar'\n```\n\nIf the parameter isn't provided, or if the value is empty, then\nall the accounts that the user has permission to see will be\nreturned.",
        "in": "query",
        "name": "search",
        "required": false,
        "schema": {
          "type": "string"
        }
      },
      "size": {
        "description": "Maximum number of records to return",
        "in": "query",
        "name": "size",
        "required": false,
        "schema": {
          "default": 100,
          "minimum": 0,
          "type": "integer"
        }
      },
      "subscriptionId": {
        "description": "The Subscription id to check Access Protection status for.",
        "in": "query",
        "name": "subscriptionId",
        "required": false,
        "schema": {
          "type": "string"
        }
      }
    },
    "schemas": {
      "AccessProtection": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ObjectReference"
          },
          {
            "properties": {
              "enabled": {
                "description": "Boolean indicating whether Access Protection is enabled. True if enabled, false otherwise.",
                "type": "boolean"
              }
            },
            "type": "object"
          }
        ]
      },
      "AccessRequest": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ObjectReference"
          },
          {
            "properties": {
              "cluster_id": {
                "description": "The id of the Cluster associated with this Access Request",
                "type": "string"
              },
              "deadline": {
                "description": "The amount of time the customer has to respond to this Access Request",
                "example": "9h2m3s",
                "type": "string"
              },
              "deadline_at": {
                "description": "The timestamp of the time by which the customer must respond to this Access Request",
                "format": "date-time",
                "type": "string"
              },
              "decisions": {
                "description": "The list of Decisions for this Access Request",
                "items": {
                  "$ref": "#/components/schemas/Decision"
                },
                "type": "array"
              },
              "duration": {
                "description": "The amount of time being requested for access to the customers Cluster or Cloud Provider account",
                "example": "9h2m3s",
                "type": "string"
              },
              "internal_support_case_id": {
                "description": "The Jira ticket associated with this Access Request in the form 'OHSS-1234'.",
                "type": "string"
              },
              "justification": {
                "description": "A customer-readable explanation as to why access is required to their Cluster or Cloud Provider account",
                "type": "string"
              },
              "organization_id": {
                "description": "The id of the OCM Organization associated with this Access Request",
                "type": "string"
              },
              "requested_by": {
                "description": "The username of the individual that made this Access Request",
                "type": "string"
              },
              "status": {
                "description": "The status of this Access Request",
                "properties": {
                  "expires_at": {
                    "description": "The timestamp at which approved access expires for this Access Request",
                    "format": "date-time",
                    "type": "string"
                  },
                  "state": {
                    "default": "Pending",
                    "description": "The current state of this Access Request",
                    "enum": [
                      "Pending",
                      "Denied",
                      "Approved",
                      "Expired"
                    ],
                    "type": "string"
                  }
                }
              },
              "subscription_id": {
                "description": "The id of the Subscription associated with this Access Request",
                "type": "string"
              },
              "support_case_id": {
                "description": "An optional, customer-facing support case id associated with this Access Request",
                "type": "string"
              }
            },
            "type": "object"
          }
        ]
      },
      "AccessRequestList": {
        "allOf": [
          {
            "$ref": "#/components/schemas/List"
          },
          {
            "properties": {
              "items": {
                "items": {
                  "$ref": "#/components/schemas/AccessRequest"
                },
                "type": "array"
              }
            },
            "type": "object"
          }
        ]
      },
      "AccessRequestPostRequest": {
        "properties": {
          "cluster_id": {
            "description": "The Cluster id associated with this Access Request. Not required when supplying the Subscription id.",
            "type": "string"
          },
          "deadline": {
            "default": "72h",
            "description": "The amount of time the customer has to respond to this Access Request",
            "example": "9h2m3s",
            "type": "string"
          },
          "duration": {
            "default": "8h",
            "description": "The amount of time being requested for access to the customers Cluster or Cloud Provider account",
            "example": "9h2m3s",
            "type": "string"
          },
          "internal_support_case_id": {
            "description": "The Jira ticket associated with this Access Request in the form 'OHSS-1234'. This must exist prior to submitting this Access Request",
            "type": "string"
          },
          "justification": {
            "description": "A customer-readable explanation as to why access is required to their Cluster or Cloud Provider account",
            "type": "string"
          },
          "subscription_id": {
            "description": "The Subscription id associated with this Access Request. Not required when supplying the Cluster id.",
            "type": "string"
          },
          "support_case_id": {
            "description": "An optional, customer-facing support case id associated with this Access Request",
            "type": "string"
          }
        },
        "required": [
          "justification",
          "internal_support_case_id"
        ],
        "type": "object"
      },
      "Decision": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ObjectReference"
          },
          {
            "properties": {
              "decided_by": {
                "description": "The username of the individual that made this Decision",
                "type": "string"
              },
              "decision": {
                "description": "The Decision made",
                "enum": [
                  "Approved",
                  "Denied",
                  "Expired"
                ],
                "type": "string"
              },
              "justification": {
                "description": "A human-readable explanation as to why this Decision was made. Optional for Approved Decisions.",
                "type": "string"
              }
            },
            "type": "object"
          }
        ]
      },
      "DecisionList": {
        "allOf": [
          {
            "$ref": "#/components/schemas/List"
          },
          {
            "properties": {
              "items": {
                "items": {
                  "$ref": "#/components/schemas/Decision"
                },
                "type": "array"
              }
            },
            "type": "object"
          }
        ]
      },
      "Error": {
        "allOf": [
          {
            "$ref": "#/components/schemas/ObjectReference"
          },
          {
            "properties": {
              "code": {
                "type": "string"
              },
              "operation_id": {
                "type": "string"
              },
              "reason": {
                "type": "string"
              }
            },
            "type": "object"
          }
        ]
      },
      "ErrorList": {
        "allOf": [
          {
            "$ref": "#/components/schemas/List"
          },
          {
            "properties": {
              "items": {
                "items": {
                  "$ref": "#/components/schemas/Error"
                },
                "type": "array"
              }
            },
            "type": "object"
          }
        ]
      },
      "List": {
        "properties": {
          "kind": {
            "type": "string"
          },
          "page": {
            "type": "integer"
          },
          "size": {
            "type": "integer"
          },
          "total": {
            "type": "integer"
          }
        },
        "required": [
          "kind",
          "page",
          "size",
          "total",
          "items"
        ],
        "type": "object"
      },
      "ObjectReference": {
        "properties": {
          "created_at": {
            "format": "date-time",
            "type": "string"
          },
          "href": {
            "type": "string"
          },
          "id": {
            "type": "string"
          },
          "kind": {
            "type": "string"
          },
          "updated_at": {
            "format": "date-time",
            "type": "string"
          }
        },
        "type": "object"
      }
    },
    "securitySchemes": {
      "Bearer": {
        "bearerFormat": "JWT",
        "scheme": "bearer",
        "type": "http"
      }
    }
  },
  "info": {
    "description": "The Access Transparency Service provides a mechanism for Red Hat SRE to request access to customer Clusters and Cloud Provider accounts, and for customers to approve or deny Access Requests.",
    "title": "Access Transparency Service API",
    "version": "0.0.1"
  },
  "openapi": "3.0.0",
  "paths": {
    "/api/access_transparency/v1/access_protection": {
      "get": {
        "parameters": [
          {
            "$ref": "#/components/parameters/organizationId"
          },
          {
            "$ref": "#/components/parameters/subscriptionId"
          },
          {
            "$ref": "#/components/parameters/clusterId"
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessProtection"
                }
              }
            },
            "description": "An Access Protection object"
          },
          "401": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "Auth token is invalid"
          },
          "403": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "Unauthorized to perform operation"
          },
          "500": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "Unexpected error occurred"
          }
        },
        "security": [
          {
            "Bearer": []
          }
        ],
        "summary": "Returns the status of Access Protection determined by the Organization id, Subscription id or Cluster id."
      }
    },
    "/api/access_transparency/v1/access_requests": {
      "get": {
        "parameters": [
          {
            "$ref": "#/components/parameters/page"
          },
          {
            "$ref": "#/components/parameters/size"
          },
          {
            "$ref": "#/components/parameters/search"
          },
          {
            "$ref": "#/components/parameters/orderBy"
          },
          {
            "$ref": "#/components/parameters/order"
          },
          {
            "$ref": "#/components/parameters/fields"
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessRequestList"
                }
              }
            },
            "description": "A JSON array of Access Request objects"
          },
          "401": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "Auth token is invalid"
          },
          "403": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "Unauthorized to perform operation"
          },
          "500": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "Unexpected error occurred"
          }
        },
        "security": [
          {
            "Bearer": []
          }
        ],
        "summary": "Returns a list of Access Requests"
      },
      "post": {
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AccessRequestPostRequest"
              }
            }
          },
          "description": "AccessRequest data",
          "required": true
        },
        "responses": {
          "201": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessRequest"
                }
              }
            },
            "description": "The Access Request was successfully created"
          },
          "400": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "Validation errors occurred"
          },
          "401": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "Auth token is invalid"
          },
          "403": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "Unauthorized to perform operation"
          },
          "409": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "An Access Request in either Pending or Approved status already exists for the given Cluster/Subscription id"
          },
          "500": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "An unexpected error occurred creating the Access Request"
          }
        },
        "security": [
          {
            "Bearer": []
          }
        ],
        "summary": "Create a new Access Request"
      }
    },
    "/api/access_transparency/v1/access_requests/{access_request_id}": {
      "get": {
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AccessRequest"
                }
              }
            },
            "description": "Access Request found by id"
          },
          "401": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "Auth token is invalid"
          },
          "403": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "Unauthorized to perform operation"
          },
          "404": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "No Access Request with specified id exists"
          },
          "500": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "Unexpected error occurred"
          }
        },
        "security": [
          {
            "Bearer": []
          }
        ],
        "summary": "Get an Access Request by id"
      },
      "parameters": [
        {
          "$ref": "#/components/parameters/access_request_id"
        }
      ]
    },
    "/api/access_transparency/v1/access_requests/{access_request_id}/decisions": {
      "get": {
        "parameters": [
          {
            "$ref": "#/components/parameters/access_request_id"
          },
          {
            "$ref": "#/components/parameters/page"
          },
          {
            "$ref": "#/components/parameters/size"
          },
          {
            "$ref": "#/components/parameters/search"
          },
          {
            "$ref": "#/components/parameters/orderBy"
          },
          {
            "$ref": "#/components/parameters/order"
          },
          {
            "$ref": "#/components/parameters/fields"
          }
        ],
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DecisionList"
                }
              }
            },
            "description": "A JSON array of Decision objects"
          },
          "401": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "Auth token is invalid"
          },
          "403": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "Unauthorized to perform operation"
          },
          "404": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "The Access Request with the specified id does not exist"
          },
          "500": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "Unexpected error occurred"
          }
        },
        "security": [
          {
            "Bearer": []
          }
        ],
        "summary": "Returns a list of Decisions for a given Access Request"
      },
      "post": {
        "parameters": [
          {
            "$ref": "#/components/parameters/access_request_id"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Decision"
              }
            }
          },
          "description": "Decision data",
          "required": true
        },
        "responses": {
          "201": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Decision"
                }
              }
            },
            "description": "The Decision was successfully created"
          },
          "400": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "Validation errors occurred"
          },
          "401": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "Auth token is invalid"
          },
          "403": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "Unauthorized to perform operation"
          },
          "500": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "An unexpected error occurred creating the Decision"
          }
        },
        "security": [
          {
            "Bearer": []
          }
        ],
        "summary": "Create a new Decision for a given Access Request"
      }
    },
    "/api/access_transparency/v1/access_requests/{access_request_id}/decisions/{decision_id}": {
      "get": {
        "responses": {
          "200": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Decision"
                }
              }
            },
            "description": "Decision found by id"
          },
          "401": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "Auth token is invalid"
          },
          "403": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "Unauthorized to perform operation"
          },
          "404": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "No Decision with the specified id exists"
          },
          "500": {
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            },
            "description": "Unexpected error occurred"
          }
        },
        "security": [
          {
            "Bearer": []
          }
        ],
        "summary": "Get a Decision by id for a given Access Request"
      },
      "parameters": [
        {
          "$ref": "#/components/parameters/access_request_id"
        },
        {
          "$ref": "#/components/parameters/decision_id"
        }
      ]
    }
  },
  "servers": [
    {
      "description": "current domain",
      "url": "http://localhost:8000"
    },
    {
      "description": "Main (production) server",
      "url": "https://api.openshift.com"
    },
    {
      "description": "Staging server",
      "url": "https://api.stage.openshift.com"
    }
  ]
}
